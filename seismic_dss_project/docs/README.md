# README

**Система прогнозирования сейсмического риска для Байкальской рифтовой зоны**

---

## 1. Назначение проекта

Программный комплекс формирует вероятностную карту землетрясений (hazard), рассчитывает ожидаемые экономические потери (risk) и оценивает качество прогнозов по метрикам CSEP. Минимальный жизнеспособный продукт (MVP) подготовлен для предзащиты магистерского проекта.

---

## 2. Основные возможности

1. **Долгосрочный прогноз (KDE)** – расчёт пространственной плотности очагов.
2. **Краткосрочная коррекция (ETAS)** – учёт афтершоковой активности последних событий.
3. **Контейнер `ProbMap`** – единый класс-обёртка над 2-D массивом вероятностей с геопривязкой.
4. **Оценка потерь** – умножение карты вероятностей на растры населения и стоимости зданий.
5. **Метрики CSEP** – лог-правдоподобие, LL-gain, POD, FAR, Brier score.
6. **Визуализация** – статичные PNG и интерактивные HTML-карты (`plotly`).

---

## 3. Структура репозитория

```
.
├── config.yaml           # Параметры работы
├── main.py               # Точка входа
├── prob_map.py           # Контейнер ProbMap
├── data_loader.py        # Загрузка каталога CSV
├── zone_model.py         # KDE-прогноз (long-term)
├── etas_model.py         # ETAS-прогноз (short-term)
├── exposure_model.py     # Подсчёт потерь
├── csep_eval.py          # Метрики качества
├── visualizer.py         # Графический вывод
├── zone_engine.py        # Экспертная система Experta
└── outputs/              # Автоматически создаётся при запуске
```

---

## 4. Системные требования

| Компонент | Версия |
| --------- | ------ |
| Python    | ≥ 3.10 |
| NumPy     | ≥ 1.25 |
| SciPy     | ≥ 1.11 |
| pandas    | ≥ 2.2  |
| rasterio  | ≥ 1.3  |
| experta   | ≥ 1.9  |
| plotly    | ≥ 5.20 |
| numba     | (опц.) |

Установите зависимости:

```bash
pip install -r requirements.txt
```



## 5. Настройка `config.yaml`

```yaml
catalog_csv: "earthquakes.csv"

region_bounds:
  lat_min: 50.0
  lat_max: 60.0
  lon_min: 100.0
  lon_max: 115.0

grid_res: 0.10

kde:
  bandwidth_km: 20

etas:
  A: 0.5
  alpha: 1.0
  c: 0.01
  p: 1.1
  d: 1.0
  q: 1.5
  R: 50.0
  training_end_date: "2023-01-01"

exposure:
  population_tiff: null   # указать файл GeoTIFF при наличии
  cost_tiff:       null

visualization:
  output_dir: "outputs"

evaluation:
  enable: true
  baseline_long_term: true
  alarm_threshold: 0.005
```

---

## 6. Запуск

```bash
python main.py
```

После выполнения в каталоге `outputs/` появятся:

* `prob_map.png` – статичная карта вероятностей
* `prob_map.html` – интерактивная карта
* `loss_map.png` – карта ожидаемых потерь (если заданы растры)

Консоль выведет блок **METRICS** с рассчитанными показателями CSEP.

---


## 7. Расширение и интеграция

* **Geo-экспорт**: функции `visualizer.py` можно дополнить сохранением GeoTIFF/GeoJSON.
* **Сейсмо-устойчивость зданий**: расширьте `exposure_model.py`, подключив слой уязвимости.
* **Параллельные вычисления**: включите numba или dask для ускорения KDE/ETAS на крупной сети.

---

## 8. Лицензия

Проект распространяется под лицензией MIT.

---

© 2025. Все права защищены.
